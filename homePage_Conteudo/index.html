<!DOCTYPE html>
<html lang="pt_br">
  
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title> SafeLinks - Pesquisa Segura de Produtos </title>

  <link rel="stylesheet" href="style.css"> <!-- HOMEPAGE ESTILOS: ARQUIVO CSS -->
  <link rel="stylesheet" href="homePageNavBarStyle.css"> <!-- HOMEPAGE NAVBAR ESTILOS: ARQUIVO CSS -->
  <link rel="stylesheet" href="homePageSearchBarStyle.css"> <!-- HOMEPAGE SEARCHBAR ESTILOS: ARQUIVO CSS -->

  <link rel="icon" href="SafeLinks_Favicon_Logo.png" type="image/png"> <!-- SITE: LOGO -->

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> <!-- HOMEPAGE ICONES: GOOGLE FONTS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <!-- HOMEPAGE ICONES: FONT AWESOME -->
</head>
  
  <body>

      <nav class="homePageNavbar" id="homePageNavbarID"> <!-- HOMEPAGE: NAVBAR -->

        <div class="navbar-container"> 
        <div class="navbar-logo" id="homePageNavBarLogo"><a href="#"> SafeLinks </a></div> <!-- HOMEPAGE: NAVBAR, LOGO -->
            <ul class="navbar-links" id="homePageNavBarLinksID"> <!-- HOMEPAGE: NAVBAR, ÍCONES COM LINKS -->
              <li id="usuarioLoginLi"><a href="homePageLogin_Conteudo/login.html"><i class="fas fa-user"></i> Usuário </a></li> <!-- HOMEPAGE: NAVBAR, LINK => USUÁRIO/LOGIN -->
              <li><a href="#"><i class="fa fa-bell" id="notificacoesIcone"></i> Notificações </a></li> <!-- HOMEPAGE: NAVBAR, LINK => NOTIFICAÇÕES -->
              <li><a href="sobre.html"><i class="fa-solid fa-circle-info"></i> Sobre </a></li> <!-- HOMEPAGE: NAVBAR, LINK => SOBRE -->
              <li><a href="dicas.html"><i class="fa-solid fa-lightbulb"></i> Dicas </a></li>
              <li class="homePageModoEscuroClaro" id="homePageModoEscuroClaroID"><i class="fas fa-moon"></i></li> <!-- <= CONCERTO NESCESSÁRIO! -->
            </ul>
            <button class="hamburguerMenu" id="hamburguerMenuID"> <!-- HOMEPAGE: NAVBAR, MENU HAMBURGUER -->
              <i class="fas fa-bars"></i> <!-- ÍCONE, MENU HAMBURGUER -->
            </button>
        </div>
      </nav>

    <div class="homePageConteudoCentral"> <!-- HOMEPAGE: CONTEÚDO DO CENTRO -->
      <header> <!-- HOMEPAGE: TÍTULO E SUBTÍTULO -->
        <div class="homePageTitulo">SafeLinks</div> <!-- HOMEPAGE: TÍTULO -->
        <div class="homePageSubTitulo">Pesquisa segura em lojas confiáveis</div> <!-- HOMEPAGE: SUBTÍTULO -->
      </header>

      <div class="homePageSearchDiv" id="homePageSearchDivID"> <!-- HOMEPAGE: BARRA DE PESQUISA E BOTÕES-->
        <div class="homePageBarraDePesquisa" id="homePageBarraDePesquisaID"> <!-- HOMEPAGE: BARRA DE PESQUISA CONTEÚDOS -->
          <input type="text" class="homePageSearchInput" id="homePageSearchInputID" autocomplete="off" placeholder="Entre com a URL de um site"> <!-- HOMEPAGE: BARRA DE PESQUISA -->
            <button class="homePageSearchButton" id="homePageSearchButtonID" aria-label="Search"> <!-- HOMEPAGE: BARRA DE PESQUISA, BOTÃO -->
              <i class="material-icons" id="homePageSearchIconID">search</i> <!-- HOMEPAGE: BARRA DE PESQUISA, BOTÃO, ÍCONE -->
            </button>
            <button class="homePageVoiceSearchButton" id="homePageVoiceSearchButtonID" aria-label="VoiceSearch"> <!-- HOMEPAGE: BARRA DE PESQUISA, BOTÃO, PESQUISE POR VOZ -->
              <i class="material-icons" id="homePageVoiceIconID">mic</i>
            </button>
        </div>

        <br>
        
        <div class="barraDePesquisaOpcoes"> <!-- HOMEPAGE: BARRA DE PESQUISA, OPÇÕES -->
          <button class="barraDePesquisaOpcoesButtons" id="barraDePesquisaLimparTexto"> <!-- HOMEPAGE: BARRA DE PESQUISA, OPÇÕES, LIMPAR TEXTO -->
            <i class="fas fa-eraser"></i> Limpar
          </button>
          <button class="barraDePesquisaOpcoesButtons" id="barraDePesquisaHistorico"> <!-- HOMEPAGE: BARRA DE PESQUISA, OPÇÕES, HISTÓRICO -->
            <i class="fas fa-history"></i> Histórico
          </button>
        </div>
      </div>

      <!-- Área para mostrar resultados da verificação de segurança -->
      <div id="resultadoVerificacao" style="display: none; margin-top: 20px; padding: 15px; border-radius: 8px; width: 100%; max-width: 600px;"></div>

      <div class="homePagePesquisasRecentes" id="homePagePesquisasRecentesID"> <!-- HOMEPAGE: BARRA DE PESQUISA RECENTES, CONTEÚDOS -->
        <div class="pesquisasRecentesTitulo">Pesquisas recentes</div> <!-- HOMEPAGE: BARRA DE PESQUISA RECENTES, TÍTULO -->
        <div class="pesquisasRecentesItems" id="pesquisasRecentesItemsID"></div> <!-- HOMEPAGE: BARRA DE PESQUISA RECENTES, ITENS PESQUISADOS -->
      </div>
    </div>

    <script src="script.js"></script> 
    <script src="theme.js"></script>
    <script src="homePagePesquisaFavoritosHistorico.js"></script>

    <script>
      // Função para verificar a segurança da URL
      function verificarUrlSegura(url) {
        const resultadoDiv = document.getElementById('resultadoVerificacao');
        resultadoDiv.style.display = 'block';
        resultadoDiv.innerHTML = '<div style="text-align: center;"><i class="fas fa-spinner fa-spin"></i> Verificando URL...</div>';
        
        fetch('safe_browsing_api.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ url: url })
        })
        .then(response => response.json())
        .then(data => {
          if (data.segura) {
            resultadoDiv.innerHTML = `
              <div style="background-color: #d4edda; color: #155724; padding: 15px; border-radius: 8px;">
                <i class="fas fa-check-circle"></i> <strong>URL Segura</strong><br>
                A URL ${data.url} é considerada segura.
                <br><strong>Verificado por Safe Browsing</strong>
              </div>
            `;
            
            // Adicionar ao histórico de pesquisas
            adicionarAoHistorico(url);
          } else {
            if (data.erro) {
              resultadoDiv.innerHTML = `
                <div style="background-color: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px;">
                  <i class="fas fa-exclamation-triangle"></i> <strong>Erro na Verificação</strong><br>
                  ${data.erro}
                </div>
              `;
            } else if (data.ameacas) {
              let ameacasHTML = '';
              data.ameacas.forEach(ameaca => {
                ameacasHTML += `<li><strong>${ameaca.tipo}</strong> em ${ameaca.plataforma}</li>`;
              });
              
              resultadoDiv.innerHTML = `
                <div style="background-color: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px;">
                  <i class="fas fa-exclamation-triangle"></i> <strong>URL Não Segura</strong><br>
                  A URL ${data.url} contém as seguintes ameaças:
                  <ul>${ameacasHTML}</ul>
                  <strong>Recomendamos não prosseguir para este site.</strong>
                  <br><strong>Verificado por Safe Browsing</strong>
                </div>
              `;
            }
          }
        })
        .catch(error => {
          resultadoDiv.innerHTML = `
            <div style="background-color: #fff3cd; color: #856404; padding: 15px; border-radius: 8px;">
              <i class="fas fa-exclamation-circle"></i> <strong>Erro de Conexão</strong><br>
              Não foi possível verificar a URL no momento. Por favor, tente novamente mais tarde.
            </div>
          `;
          console.error('Erro:', error);
        });
      }
      
      // Função para adicionar ao histórico
      function adicionarAoHistorico(url) {
        // Implementar a lógica para adicionar ao histórico de pesquisas
        console.log('Adicionando ao histórico:', url);
        // Aqui você pode implementar a lógica para salvar no localStorage
        let historico = JSON.parse(localStorage.getItem('searchHistory')) || [];
        if (!historico.includes(url)) {
          historico.unshift(url);
          // Manter apenas os últimos 10 itens
          historico = historico.slice(0, 10);
          localStorage.setItem('searchHistory', JSON.stringify(historico));
          
          // Atualizar a exibição do histórico
          atualizarExibicaoHistorico();
        }
      }
      
      // Função para atualizar a exibição do histórico
      function atualizarExibicaoHistorico() {
        const historicoItems = document.getElementById('pesquisasRecentesItemsID');
        const historico = JSON.parse(localStorage.getItem('searchHistory')) || [];
        
        historicoItems.innerHTML = '';
        
        historico.forEach(url => {
          const item = document.createElement('div');
          item.className = 'pesquisaRecenteItem';
          item.textContent = url;
          item.style.cursor = 'pointer';
          item.style.margin = '5px 0';
          item.style.padding = '5px';
          item.style.borderRadius = '4px';
          item.style.backgroundColor = '#f0f0f0';
          item.addEventListener('click', () => {
            document.getElementById('homePageSearchInputID').value = url;
            verificarUrlSegura(url);
          });
          
          historicoItems.appendChild(item);
        });
      }
      
      // Adicionar evento de clique no botão de pesquisa
      document.getElementById('homePageSearchButtonID').addEventListener('click', function() {
        const url = document.getElementById('homePageSearchInputID').value.trim();
        if (url) {
          verificarUrlSegura(url);
        } else {
          alert('Por favor, digite uma URL para verificar.');
        }
      });
      
      // Adicionar evento de pressionar Enter no campo de pesquisa
      document.getElementById('homePageSearchInputID').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          const url = this.value.trim();
          if (url) {
            verificarUrlSegura(url);
          } else {
            alert('Por favor, digite uma URL para verificar.');
          }
        }
      });
      
      // Inicializar a exibição do histórico
      document.addEventListener('DOMContentLoaded', function() {
        atualizarExibicaoHistorico();
      });
    </script>

  </body>

</html>